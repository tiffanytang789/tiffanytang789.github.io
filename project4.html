<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Project 4</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1100px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.5;
        }

        h1, h2 {
            text-align: left;
        }

        section {
            margin-bottom: 40px;
        }

        .figure-single,
        .image-row,
        .image-grid-2x2 {
            margin: 16px 0;
        }

        figure {
            margin: 0;
            text-align: center;
        }

        figure img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 0 auto;
        }

        figcaption {
            margin-top: 6px;
            font-size: 0.9rem;
            color: #555;
        }

        /* Generic horizontal image row (each image has its own caption) */
        .image-row {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }

        .image-row figure {
            flex: 1 1 18%; /* Good for 5–6 images per row on large screens */
            min-width: 120px;
        }

        /* 2x2 image grid */
        .image-grid-2x2 {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            justify-items: center;
        }

        .image-grid-2x2 figure {
            width: 100%;
        }

        /* Row where a single caption is shared by all images */
        .image-row-shared-caption {
            margin: 16px 0;
        }

        .image-row-shared-caption .images {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }

        .image-row-shared-caption .images img {
            max-width: 100%;
            height: auto;
            display: block;
        }

        .image-row-shared-caption figcaption {
            margin-top: 8px;
        }
        .image-row-6 {
            display: flex;
            justify-content: space-between;
            gap: 10px;
        }
        
        .image-row-6 img {
            width: 15%;   /* ~6 images across with some gap */
            height: auto;
        }


        /* Simple styling for GIFs (optional, same as regular images) */
        .gif {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 0 auto;
        }
    </style>
</head>
<body>
    <h1>Project 4</h1>

    <!-- ================= Part 0 ================= -->
    <section id="part0">
        <h2>Part 0</h2>

        <!-- Two images side by side, each with its own caption -->
        <div class="image-row">
            <figure>
                <!-- TODO: replace src with your file name -->
                <img src="part0a.png.PNG" alt="Part 0 image 1">
                <figcaption>camera frustums visualization in angle 1</figcaption>
            </figure>

            <figure>
                <!-- TODO: replace src with your file name -->
                <img src="part0b.png.PNG" alt="Part 0 image 2">
                <figcaption>camera frustums visualization in angle 2</figcaption>
            </figure>
        </div>
    </section>

    <!-- ================= Part 1 ================= -->
    <section id="part1">
        <h2>Part 1</h2>

        <!-- Paragraph -->
        <p>
            <!-- TODO: Replace this text with your Part 1 description -->
            MLP: layers=4, width=256, PE L=10, lr=0.01
Training on mps for 2000 iters, batch size 10000
        </p>

        <!-- Single image with caption -->
        <figure class="figure-single">
            <img src="fox.jpeg" alt="Part 1 image 1">
            <figcaption>Original Fox Image</figcaption>
        </figure>

        <!-- Row of 5 images with individual captions -->
        <div class="image-row">
            <figure>
                <img src="fprogress_w256_L10_iter0000.png" alt="Part 1 row 1 image 1">
                <figcaption>Iteration 0</figcaption>
            </figure>
            <figure>
                <img src="fprogress_w256_L10_iter0500.png" alt="Part 1 row 1 image 2">
                <figcaption>Iteration 500</figcaption>
            </figure>
            <figure>
                <img src="fprogress_w256_L10_iter1000.png" alt="Part 1 row 1 image 3">
                <figcaption>Iteration 1000</figcaption>
            </figure>
            <figure>
                <img src="fprogress_w256_L10_iter1500.png" alt="Part 1 row 1 image 4">
                <figcaption>Iteration 1500</figcaption>
            </figure>
            <figure>
                <img src="fprogress_w256_L10_iter2000.png" alt="Part 1 row 1 image 5">
                <figcaption>Iteration 2000</figcaption>
            </figure>
        </div>

       

        <!-- 4 images in 2x2 layout with captions -->
        <div class="image-grid-2x2">
            <figure>
                <img src="frecon_final_w64_L0.png" alt="Part 1 grid 1 image 1">
                <figcaption>Positional Encoding with L = 0 and w = 64 </figcaption>
            </figure>
            <figure>
                <img src="frecon_final_w256_L0.png" alt="Part 1 grid 1 image 2">
                <figcaption>Positional Encoding with L = 0 and w = 256 </figcaption>
            </figure>
            <figure>
                <img src="frecon_final_w64_L10.png" alt="Part 1 grid 1 image 3">
                <figcaption>Positional Encoding with L = 10 and w = 64 </figcaption>
            </figure>
            <figure>
                <img src="frecon_final_w256_L10.png" alt="Part 1 grid 1 image 4">
                <figcaption>Positional Encoding with L = 10 and w = 256 </figcaption>
            </figure>
        </div>

        <!-- Single image with caption -->
        <figure class="figure-single">
            <img src="cola.jpeg" alt="Part 1 image 3">
            <figcaption>Original Cola Image</figcaption>
        </figure>

        <!-- Second row of 5 images with captions -->
        <div class="image-row">
            <figure>
                <img src="progress_w256_L10_iter0000.jpeg" alt="Part 1 row 2 image 1">
                <figcaption>Iteration 0</figcaption>
            </figure>
            <figure>
                <img src="progress_w256_L10_iter0500.jpeg" alt="Part 1 row 2 image 2">
                <figcaption>Iteration 500</figcaption>
            </figure>
            <figure>
                <img src="progress_w256_L10_iter1000.jpeg" alt="Part 1 row 2 image 3">
                <figcaption>Iteration 1000</figcaption>
            </figure>
            <figure>
                <img src="progress_w256_L10_iter1500.jpeg" alt="Part 1 row 2 image 4">
                <figcaption>Iteration 1500</figcaption>
            </figure>
            <figure>
                <img src="progress_w256_L10_iter2000.jpeg" alt="Part 1 row 2 image 5">
                <figcaption>Iteration 2000</figcaption>
            </figure>
        </div>

        <!-- Second 2x2 grid with captions -->
        <div class="image-grid-2x2">
            <figure>
                <img src="recon_final_w64_L0.jpeg" alt="Part 1 grid 2 image 1">
                <figcaption>Positional Encoding with L = 0 and w = 64</figcaption>
            </figure>
            <figure>
                <img src="recon_final_w256_L0.jpeg" alt="Part 1 grid 2 image 2">
                <figcaption>Positional Encoding with L = 0 and w = 256</figcaption>
            </figure>
            <figure>
                <img src="recon_final_w64_L10.jpeg" alt="Part 1 grid 2 image 3">
                <figcaption>Positional Encoding with L = 10 and w = 64</figcaption>
            </figure>
            <figure>
                <img src="recon_final_w256_L10.jpeg" alt="Part 1 grid 2 image 4">
                <figcaption>Positional Encoding with L = 10 and w = 256</figcaption>
            </figure>
        </div>

        <!-- Final image with caption -->
        <figure class="figure-single">
            <img src="cola_training_curve.png" alt="Part 1 image 4">
            <figcaption>Training Curve for Cola Image with L = 10 and w = 256</figcaption>
        </figure>
    </section>

    <!-- ================= Part 2 ================= -->
    <section id="part2">
        <h2>Part 2</h2>

        <!-- Paragraph -->
        

        <p><strong>2.1 Camera & Ray Geometry:</strong>  
        I implemented a unified <code>transform()</code> that works for both NumPy and PyTorch, converting 3D points from camera to world coordinates. I added <code>pixel_to_camera()</code> to invert the pinhole model and used it inside <code>RaysData</code> to build ray origins and directions for every pixel across all training images.</p>
        
        <p><strong>2.2 Ray & Point Sampling:</strong>  
        I wrote <code>RaysData</code> to flatten all training images into a single ray dataset stored on CPU. Each iteration samples a random batch of rays and only moves those rays to GPU. I implemented <code>sample_along_rays()</code> for stratified sampling between <code>near</code> and <code>far</code> bounds to produce (B, S, 3) 3D points along each ray.</p>
        
        <p><strong>2.3 Visualization:</strong>  
        I added a <code>visualize_rays_and_samples()</code> helper using Viser that shows camera frustums, sampled rays, and 3D points. I ran it once for the screenshot deliverable.</p>
        
        <p><strong>2.4 NeRF Network:</strong>  
        I implemented positional encoding and a standard NeRF MLP: 8 layers × 256 hidden units, with PE applied to both 3D points and view directions. The network outputs density (sigma) and RGB, using ReLU for sigma and sigmoid for color.</p>
        
        <p><strong>2.5 Volume Rendering & Training:</strong>  
        I implemented the NeRF volume rendering equation (alphas, transmittance, and weighted RGB). The MSE loss is computed against the ground-truth pixel colors. I trained LEGO with global random ray sampling, computed validation PSNR, saved progress images, and stored all stats into <code>lego_stats.npz</code>.</p>
        
       
        <!-- Single image with caption -->
        <figure class="figure-single">
            <img src="part23.png.PNG" alt="Part 2 image 1">
            <figcaption>Visualization of rays and samples with cameras</figcaption>
        </figure>
        
        <!-- Row of 6 images sharing one caption -->
        <figure class="image-row-shared-caption">
            <div class="images">
                <img src="lego_progress_iter_00001.png" alt="Part 2 row 2 image 1">
                <img src="lego_progress_iter_00200.png" alt="Part 2 row 2 image 2">
                <img src="lego_progress_iter_00400.png" alt="Part 2 row 2 image 3">
                <img src="lego_progress_iter_00600.png" alt="Part 2 row 2 image 4">
                <img src="lego_progress_iter_00800.png" alt="Part 2 row 2 image 5">
                <img src="lego_progress_iter_01000.png" alt="Part 2 row 2 image 6">
            </div>
            <figcaption>Training progression visualization with predicted images across iterations.</figcaption>
        </figure>
        <!-- Row of 2 images with individual captions -->
        <div class="image-row">
            <figure>
                <img src="lego_train.png" alt="Part 2 row 1 image 1">
                <figcaption>Training PSNR</figcaption>
            </figure>
            <figure>
                <img src="lego_val.png" alt="Part 2 row 1 image 2">
                <figcaption>Validation PSNR</figcaption>
            </figure>
        </div>


        

        <!-- GIF -->
        <figure class="figure-single">
            <img class="gif" src="lego_spherical.gif" alt="Part 2 GIF">
            <figcaption>Spherical rendering video of the Lego using provided test cameras</figcaption>
        </figure>
    </section>

    <!-- ================= Part 2.6 ================= -->
    <section id="part2-6">
        <h2>Part 2.6</h2>
        
        <p><strong>Changed near/far bounds:</strong>  
        My real setup is much smaller than LEGO, so I used <code>near=0.02</code> and <code>far=0.5</code> to ensure samples fall on the object.</p>
        
        <p><strong>Validation handling:</strong>  
        My dataset sometimes has zero validation images, so I added a robust <code>has_val</code> check and disabled validation when needed, using a training pose for preview renders.</p>
        
        <p><strong>Memory adjustments:</strong>  
        To avoid GPU OOM on the remote server, I kept all rays on CPU in <code>RaysData</code> and only transferred mini-batches to GPU each step.</p>
        
        <p><strong>Training:</strong>  
        I kept the same NeRF architecture and hyperparameters as LEGO (64 samples, batch 10k, lr 5e-4). Training statistics were saved to <code>my_stats.npz</code> for plotting.</p>
        
        <p><strong>Orbit GIF:</strong>  
        Instead of provided test poses, I generated new camera poses by rotating around one training camera position and rendered a 60-frame GIF for novel-view synthesis.</p>
        <p><strong>Reflection:</strong> 
        There is an issue of rendering the GIF, however, I think this is more of data sampling issue rather than the model issue because I use the same model for lego and it worked. However, when it comes to my own dataset where lots of camera views are eliminated due to the tags getting blocked, it affected the overal rendering process. 


      

        <!-- Paragraph -->
         

        <!-- Row of 6 images sharing one caption -->
        <figure class="image-row-shared-caption">
            <div class="image-row-6">
                <img src="my_progress_iter_00001.png" alt="Part 2.6 row image 1">
                <img src="my_progress_iter_00200.png" alt="Part 2.6 row image 2">
                <img src="my_progress_iter_00400.png" alt="Part 2.6 row image 3">
                <img src="my_progress_iter_00600.png" alt="Part 2.6 row image 4">
                <img src="my_progress_iter_00800.png" alt="Part 2.6 row image 5">
                <img src="my_progress_iter_01000.png" alt="Part 2.6 row image 6">
            </div>
            <figcaption>Intermediate renders of the scene during training</figcaption>
        </figure>
        <!-- Single image with caption -->
        <figure class="figure-single">
            <img src="my_train.png" alt="Part 2.6 image 1">
            <figcaption>Training loss over iterations</figcaption>
        </figure>
         
          <!-- GIF -->
        <figure class="figure-single">
            <img class="gif" src="https://github.com/tiffanytang789/tiffanytang789.github.io/blob/cd13352b6f43b22d54601b5a3ba053d7751163d0/my_orbit.gif" alt="Part 2.6 GIF">
            <figcaption>GIF for my own dataset</figcaption>
        </figure>
    </section>
</body>
</html>
